/**
 * AppFrame - Main application shell using CSS Grid
 * 
 * Header Usage Guidelines:
 * - App Header: Fixed at top, 48-64px (max 80px) - for global navigation
 * - Page Header: Sticky below app header, 56-72px (max 96px) - for contextual actions
 * - Max Combined Height: 144px total for all fixed headers
 * 
 * When to use:
 * - App header only: Dashboard, list views, search results
 * - App + Page header: Entity detail pages, form pages, settings
 * - No fixed headers: Full-screen focus mode, command-centered layouts
 */

.frame {
  display: grid;
  grid-template-areas:
    "appHeader appHeader appHeader"
    "nav pageHeader rightRail"
    "nav main rightRail";
  grid-template-rows:
    var(--app-header-height, 0)
    var(--page-header-height, 0)
    1fr;
  grid-template-columns:
    var(--nav-width, 0)
    1fr
    var(--right-rail-width, 0);
  min-height: 100dvh;
  width: 100vw;
  max-width: 100vw;
  overflow: hidden;
  box-sizing: border-box;
}

/* CSS Variables - Header Heights */
:root {
  --app-header-height: 64px;
  --app-header-height-max: 80px;
  --page-header-height: 72px;
  --page-header-height-max: 96px;
  --max-total-header-height: 144px;

  /* Navigation */
  --nav-width: 240px;
  --nav-width-collapsed: 64px;

  /* Right Rail */
  --right-rail-width: 320px;

  /* Spacing */
  --spacing-unit: 8px;
  --spacing-xs: calc(var(--spacing-unit) * 1);
  --spacing-sm: calc(var(--spacing-unit) * 2);
  --spacing-md: calc(var(--spacing-unit) * 3);
  --spacing-lg: calc(var(--spacing-unit) * 4);
  --spacing-xl: calc(var(--spacing-unit) * 6);
}

/* App Header Area */
.appHeader {
  grid-area: appHeader;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 1000;
  height: var(--app-header-height);
  max-height: var(--app-header-height-max);
  background-color: var(--mui-palette-background-paper);
  border-bottom: 1px solid var(--mui-palette-divider);
}

/* Navigation Area */
.nav {
  grid-area: nav;
  position: fixed;
  top: var(--app-header-height);
  left: 0;
  bottom: 0;
  width: var(--nav-width);
  z-index: 999;
  background-color: var(--mui-palette-background-default);
  border-right: 1px solid var(--mui-palette-divider);
  overflow-y: auto;
  transition: width 0.2s ease;
}

.navCollapsed {
  width: var(--nav-width-collapsed);
}

/* Page Header Area */
.pageHeader {
  grid-area: pageHeader;
  position: sticky;
  top: var(--app-header-height);
  z-index: 998;
  height: var(--page-header-height);
  max-height: var(--page-header-height-max);
  background-color: var(--mui-palette-background-paper);
  border-bottom: 1px solid var(--mui-palette-divider);
}

/* Main Content Area */
.main {
  grid-area: main;
  overflow-y: auto;
  overflow-x: hidden;
  height: calc(
    100dvh - var(--app-header-height) - var(--page-header-height, 0)
  );
  background-color: var(--mui-palette-background-default);
  width: 100%;
  min-width: 0; /* Allow grid items to shrink below content size */
  box-sizing: border-box;
  position: relative;
}

.mainContent {
  padding: var(--spacing-md);
  min-height: 100%;
  width: 100%;
  box-sizing: border-box;
}

/* Right Rail Area */
.rightRail {
  grid-area: rightRail;
  position: fixed;
  top: var(--app-header-height);
  right: 0;
  bottom: 0;
  width: var(--right-rail-width);
  z-index: 997;
  background-color: var(--mui-palette-background-default);
  border-left: 1px solid var(--mui-palette-divider);
  overflow-y: auto;
}

/* Variants */
.noAppHeader .frame {
  grid-template-areas:
    "nav pageHeader rightRail"
    "nav main rightRail";
  grid-template-rows:
    var(--page-header-height, 0)
    1fr;
}

.noAppHeader .nav {
  top: 0;
}

.noAppHeader .pageHeader {
  top: 0;
}

.noAppHeader .main {
  height: calc(100dvh - var(--page-header-height, 0));
}

.noPageHeader .frame {
  grid-template-areas:
    "appHeader appHeader appHeader"
    "nav main rightRail";
  grid-template-rows:
    var(--app-header-height)
    1fr;
}

.noPageHeader .nav {
  top: var(--app-header-height);
}

.noPageHeader .main {
  height: calc(100dvh - var(--app-header-height));
}

.noNav .frame {
  grid-template-areas:
    "appHeader appHeader appHeader"
    "pageHeader pageHeader rightRail"
    "main main rightRail";
  grid-template-columns:
    1fr
    var(--right-rail-width, 0);
}

.noNav .main {
  margin-left: 0;
}

.noRightRail .frame {
  grid-template-areas:
    "appHeader appHeader appHeader"
    "nav pageHeader ."
    "nav main .";
  grid-template-columns:
    var(--nav-width, 0)
    1fr
    0;
}

/* Responsive Breakpoints */
@media (max-width: 768px) {
  .frame {
    grid-template-areas:
      "appHeader"
      "pageHeader"
      "main";
    grid-template-columns: 1fr;
    grid-template-rows:
      var(--app-header-height, 0)
      var(--page-header-height, 0)
      1fr;
  }

  .nav {
    position: fixed;
    top: var(--app-header-height);
    left: -100%;
    width: 280px;
    transition: left 0.3s ease;
    z-index: 1001;
  }

  .navOpen {
    left: 0;
  }

  .rightRail {
    position: fixed;
    top: var(--app-header-height);
    right: -100%;
    width: 280px;
    transition: right 0.3s ease;
    z-index: 1001;
  }

  .rightRailOpen {
    right: 0;
  }

  .main {
    margin-left: 0;
    height: calc(
      100dvh - var(--app-header-height) - var(--page-header-height, 0)
    );
  }
}

/* Highlight Overlays */
/* Note: .appHeader, .pageHeader, .nav, and .rightRail already have position: fixed or sticky.
   We don't add position: relative to them as it would break their positioning.
   The overlays work correctly with absolute positioning relative to these already-positioned containers. */

/* Main content overlay needs to cover full scrollable height */
.mainContent {
  position: relative;
}

.highlightOverlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 10000;
  pointer-events: none;
  border: 2px solid;
  border-color: rgba(25, 118, 210, 0.6);
  background-color: rgba(25, 118, 210, 0.08);
  box-sizing: border-box;
}

/* For main content, overlay should cover full height of scrollable content */
/* The overlay is inside .mainContent which expands to fit all content */
.mainHighlightOverlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  /* Match the full height of .mainContent, which expands with content */
  height: 100%;
  min-height: 100%;
  /* Remove bottom constraint to allow expansion beyond viewport */
  bottom: auto;
}

.highlightLabel {
  position: absolute;
  top: 8px;
  left: 8px;
  background-color: rgba(25, 118, 210, 0.95);
  color: white;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 12px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
  z-index: 10001;
  pointer-events: none;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen",
    "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue",
    sans-serif;
}

/* Dark mode adjustments */
[data-mui-color-scheme="dark"] .highlightOverlay {
  border-color: rgba(144, 202, 249, 0.6);
  background-color: rgba(144, 202, 249, 0.08);
}

[data-mui-color-scheme="dark"] .highlightLabel {
  background-color: rgba(144, 202, 249, 0.95);
  color: rgba(0, 0, 0, 0.87);
}
